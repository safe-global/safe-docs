import { Tabs } from 'nextra/components'

# `useUpdateThreshold`

Executes a Safe transaction to update the threshold of the Safe connected to the [`SafeProvider`](./safeprovider.mdx).

- If the `threshold` of the connected Safe is greater than `1`, it creates the Safe transaction and submits it to the Safe Transaction Service to collect the signatures from the Safe owners.
- If the `threshold` of the connected Safe is `1`, it executes the Safe transaction.

## Usage

{/* <!-- vale off --> */}

<Tabs items={['App.tsx', 'main.tsx']}>
  <Tabs.Tab>
    ```typescript
    import { useUpdateThreshold } from '@safe-global/safe-react-hooks'
    
    function App() {
      const {
        updateThreshold,
        data,
        // ...
      } = useUpdateThreshold()

      const threshold = 3

      return (
        <>
          <button onClick={() => updateThreshold({ threshold })}>
            Update Threshold
          </button>
          {data && JSON.stringify(data)}
        </>
      )
    }

    export default App
    ```
  </Tabs.Tab>
  <Tabs.Tab>
    ```typescript
    import ReactDOM from 'react-dom/client'
    import { createConfig, SafeProvider } from '@safe-global/safe-react-hooks'
    import { sepolia } from 'viem/chains'
    import App from './App.tsx'

    const config = createConfig({
      chain: sepolia,
      provider,
      signer,
      safeAddress
    })

    const root = document.getElementById('root')
    
    ReactDOM.createRoot(root).render(
      <SafeProvider config={config}>
        <App />
      </SafeProvider>
    )
    ```
  </Tabs.Tab>
</Tabs>

{/* <!-- vale on --> */}

## Parameters

`UseUpdateThresholdParams`

Parameters to customize the hook behavior.

```typescript
import { UseUpdateThresholdParams } from '@safe-global/safe-react-hooks'
```

### `config` (Optional)

- **Type**: `SafeConfigWithSigner`

The configuration used instead of the one from the nearest [`SafeProvider`](./safeprovider.mdx).

{/* <!-- vale off --> */}

<Tabs items={['index.tsx', 'config.ts']}>
  <Tabs.Tab>
    ```typescript
    import config from './index.ts'

    const result = useUpdateThreshold({
      config
    })
    ```
  </Tabs.Tab>
  <Tabs.Tab>
    ```typescript
    import { createConfig } from '@safe-global/safe-react-hooks'
    import { sepolia } from 'viem/chains'

    const config = createConfig({
      chain: sepolia,
      provider,
      signer,
      safeOptions: {
        owners: ['0x...', '0x...', '0x...'],
        threshold: 2
      }
    })
    ```
  </Tabs.Tab>
</Tabs>

{/* <!-- vale on --> */}

## Returns 

`UseUpdateThresholdReturnType`

The react-query [`UseMutationResult`](https://tanstack.com/query/latest/docs/framework/react/reference/useMutation).

```typescript
import { UseUpdateThresholdReturnType } from '@safe-global/safe-react-hooks'
```

### `updateThreshold`

`UseMutateFunction<SafeClientResult, Error, UpdateThresholdVariables, unknown>`

Function for sending a transaction to update the threshold. It's a react-query [`mutate`](https://tanstack.com/query/latest/docs/framework/react/reference/useMutation) function.

#### Parameters

- `UpdateThresholdVariables`: Variables to update the threshold.
  - `threshold` (number): New threshold value.

#### Returns

In the `data` property of the react-query mutation result, we will have a [`SafeClientResult`](https://github.com/safe-global/safe-core-sdk/blob/9fca59736c418dc6253404b4a7784e2245d83312/packages/sdk-starter-kit/src/types.ts#L67-L85) object containing the result of the transaction that updated the threshold.

### `updateThresholdAsync`

`UseMutateAsyncFunction<SafeClientResult, Error, UpdateThresholdVariables, unknown>`

Asynchronous function for sending a transaction to update the threshold. It's a react-query [`mutateAsync`](https://tanstack.com/query/v4/docs/framework/react/reference/useMutation) function.

#### Parameters

- `UpdateThresholdVariables`: Variables to update the threshold.
  - `threshold` (number): New threshold value.

#### Returns

In the `data` property of the react-query mutation result, we will have a [`SafeClientResult`](https://github.com/safe-global/safe-core-sdk/blob/9fca59736c418dc6253404b4a7784e2245d83312/packages/sdk-starter-kit/src/types.ts#L67-L85) object containing the result of the transaction that updated the threshold.

## Caveats

The `updateThreshold` and `updateThresholdAsync` methods are used to send a transaction to update a Safe account's threshold. It covers transaction flows that you would typically need to implement yourself if you're using a more advanced kit, such as the `protocol-kit` in conjunction with the `api-kit`.

The threshold can only be updated by the owners of the Safe and only if the Safe account is already deployed (you are using `safeAddress` or the `safeOptions` counterfactual address prediction derives an existing Safe account). If being used for a Safe account that has not been deployed yet, the methods will fail before sending the transaction.

We can distinguish two main cases when using these methods:

  - In the case the Safe is a multisig account (more than one owner and threshold greater than 1), the methods will propose a transaction to update the threshold. The transaction is not sent to the blockchain immediately, but is stored in our Transaction Service. This is because you need more signatures than just the one for the `signer` used to create the client.
  - In the case the Safe is a single-owner account (threshold equal to 1), the transaction to update the threshold is sent directly to the blockchain without being stored in our services, as it is not necessary.
