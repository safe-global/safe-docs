import { Tabs } from "nextra/components";

# `sendSafeOperation`

This method allow to send SafeOperations from a group of transactions and will convert your transactions in a batch:

- If the threshold > 1 it will save for later the SafeOperation using the Transaction Service. You must confirmSafeOperation() with other owners
- If the threshold = 1 the SafeOperation can be submitted to the bundler so it will execute it immediately

In any case, if the Safe account is not deployed yet, sending it to the bundler will deploy it before executing the transactions. You need to ensure you have enough funds in the Safe address (or counterfactual) or if you are sponsoring it in the paymaster contract.

## Usage

{/* <!-- vale off --> */}

<Tabs items={["send-safe-operation.ts", "setup.ts"]}>
  <Tabs.Tab>
    ```typescript 
      const transactions = [{
        to: '0x...',
        value: '0',
        data '0x...',
      }, {
        to: '0x...',
        value: '0',
        data '0x...',
      }]

      const safeOperationResult = await safeOperationsClient.sendSafeOperation({
        transactions,
        validAfter: Number(timestamp - 60_000n),
        validUntil: Number(timestamp + 60_000n)
      })
    ```

  </Tabs.Tab>
  <Tabs.Tab>
    ```typescript 
      const safeClient = await createSafeClient({
        provider,  
        signer,
        safeAddress
      })

      const safeOperationsClient = await safeClient.extend(safeOperations({
          bundlerUrl
        },
        {
          isSponsored,
          paymasterUrl
        }
      }))
    ```

  </Tabs.Tab>
</Tabs>

{/* <!-- vale on --> */}

## Returns

`SafeClientResult`

An object with the result of the send Safe Operation.

## Parameters

### `transactions`

- **Type:** `TransactionBase[]`

An array of transactions to be batched and sent to the bundler. Each transaction is represented by an to, value, data object as any regular Ethereum transaction.

    1.	`to`: This is the address of the recipient of the transaction.
    2.	`value`: This specifies the amount of ether (in wei) being transferred from the sender to the recipient. If you are invoking a smart contract without sending any ether, this value can be zero.
    3.	`data`: This field contains extra information sent along with the transaction. For standard ether transfers between addresses, this field is typically empty. However, when interacting with smart contracts, this field carries the encoded function call and parameters.

### `amountToApprove` (optional)

- **Type:** `bigint`

The amount to approve for the SafeOperation

### `validUntil` (optional)

- **Type:** `number`

The `validUntil` timestamp for the SafeOperation

### `validAfter` (optional)

- **Type:** `number`

The `validAfter` timestamp for the SafeOperation

### `feeEstimator` (optional)

- **Type:** `IFeeEstimator`

An object implementing the IFeeEstimator interface to estimate the fee for the SafeOperation

```typescript
IFeeEstimator {
    setupEstimation?: EstimateFeeFunction;
    adjustEstimation?: EstimateFeeFunction;
    getPaymasterEstimation?: EstimateSponsoredFeeFunction;
}
```

This methods are going to be called as hooks at different stages of the SafeOperation gas estimation:

- `setupEstimation`: Called before calling the standard `eth_estimateUserOperationGas`
- `adjustEstimation`: Called after calling the standard `eth_estimateUserOperationGas`
- `getPaymasterEstimation`: Called if the operation it's being sponsored to adjust the `paymasterAndData` property
