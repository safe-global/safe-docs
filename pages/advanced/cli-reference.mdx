import { Callout } from 'nextra/components'


# Reference

There are two operation modes in Safe CLI:

- **blockchain**: The default mode. Use the `blockchain` command to enable it. Transactions are sent to the blockchain.
- **tx-service**: Use the `tx-service` command to enable it. Transactions are sent to the Safe Transaction Service (if available on the network), and you can see them on the Safe \{Wallet\} web interface
and mobile app. At least one signer is needed to send transactions to the service. Transactions are *not executed*. It requires *Safe\{Core\} API running on the network*.

## Common operations

<Callout type='info' emoji='ℹ️'>
  You must first load the sender's private key. When loading an owner, it will be set automatically.
</Callout>

- `send_custom <address> <value-wei> <data-hex-str> [--delegate] [--safe-nonce <int>]`:
  Sends a custom transaction from the Safe to a contract. If `--delegate` is set, a `delegatecall`
  will be triggered.
- `send_ether <address> <value-wei> [--safe-nonce <int>]`:
  Sends ether from the Safe to another account
- `send_erc20 <address> <token_address> <value> [--safe-nonce <int>]`:
  Send the ERC-20 token from the Safe to another account
- `approve_hash <keccak-hexstr-hash> <sender-address>`: Approves a `safe-tx-hash` for the provided sender address.
- `add_owner <address>`: Adds a new owner `address` to the Safe.
- `remove_owner <address>`: Removes an owner `address` from the Safe.
- `change_threshold <integer>`: Changes the `threshold` of the Safe.
- `enable_module <address>`: Enable module `address`
- `disable_module <address>`: Disable module `address`.
- `update`: Updates the Safe to the latest version (if you are on a known network like `Goerli` or `Mainnet`).

<Callout type="warning" emoji="⚠️">
  Only use the following operations if you are sure about what you are doing, as they can result in all your funds getting lost.
</Callout>

- `change_fallback_handler <address>`: Updates the fallback handler to be `address`. Supported by Safes with `version >= v1.1.0`.
- `change_guard <address>`: Updates the guard to be `address`. Supported by Safes with `version >= v1.3.0`.
- `change_master_copy <address>`: Updates the master copy to be `address`. It's used to update the Safe.
- `update_to_l2 <address>`: Updates a v1.1.1, v1.3.0, or v1.4.1 non-L2 Safe to an L2 Safe supported by Safe Wallet UI.
  The migration contract address needs to be provided.
  It can be found [here](https://github.com/safe-global/safe-contracts/blob/main/contracts/libraries/SafeToL2Migration.sol).
  The nonce for the Safe must be 0, and supported versions are v1.1.1, v1.3.0, and v1.4.1.


## Operations only in the tx-service mode

- `balances`: Returns a list of balances for ERC20 tokens and ether.
- `history`: History of multi-sig transactions (including pending).
- `execute-tx <safe-tx-hash>`: Execute a pending transaction with enough signatures.
- `sign-tx <safe-tx-hash>`: Sign a transaction with the loaded owners for the provided `SafeTxHash`.
- `sign_message [--eip191_message <str>] [--eip712_path <file-path>]`: sign the provided string message provided by standard input or the `EIP712` provided by file.
- `batch-txs <safe-nonce> <safe-tx-hash> [ <safe-tx-hash> ... ]`: Batch transactions into one Multisig
  transaction using the provided `safe-nonce.` Any safe-tx can be used, like transactions from other Safes, 
  already executed transactions, pending execution, etc. The only limitation is that the *transactions from other networks cannot be used*. The batching order will follow the same order of the
  `safe-tx-hashes` provided.
- `get_delegates`: Returns a list of *delegates* for the Safe. A *delegate* can be used when you *trust an address to post transactions to the tx-service on your behalf*. If a transaction is not trusted (posted to the service and not signed by a delegate or an owner of the Safe), it will be stored in the service but not shown in the Safe \{Wallet\} web interface
and mobile app.
- `add_delegate <address> <label> <owner-address>`: Adds a new delegate `address` for the `owner` of the Safe.
- `remove_delegate <address> <owner-address>`: Removes a delegate `address` from the Safe.
- `remove_proposed_transaction <safe_tx_hsh>`: Removes a proposed non-executed transaction with the owner's signature that proposed the transaction.

<Callout type="warning" emoji="⚠️">
  Only use the following operation if you are sure about what you are doing, as they can result in all your funds getting lost.
</Callout>

- `drain <address>`: Sends all Ether and ER-C20 funds to the provided account.

## Refresh the Safe CLI

If the information in the information bar is outdated or there's any problem, you can force the `safe-cli` to update the information about the Safe using:
```bash
> refresh
```

## Use custom contracts

Safe CLI comes with the official deterministic Safe contract addresses deployed on multiple chains configured by default. If you want to use your own, you can edit the file `safe_cli/safe_addresses.py`

Be careful when modifying these addresses, as the funds in a Safe can get stuck if an invalid address is used when updating to an invalid Safe Master Copy.

## Demos

### Sending Ether using a Trezor hardware wallet

[![Sending Ether using a Trezor hardware wallet](https://asciinema.org/a/9BrQKYQRXbysmEL8rw1jDWZhn.svg)](https://asciinema.org/a/9BrQKYQRXbysmEL8rw1jDWZhn)

### Create a remove owner transaction in the Transaction Service

[![Create a remove owner transaction in the Transaction Service](https://asciinema.org/a/oV5UbXW2g1VZo2yKDQIxi0jYb.svg)](https://asciinema.org/a/oV5UbXW2g1VZo2yKDQIxi0jYb)