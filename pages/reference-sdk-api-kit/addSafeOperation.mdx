import { Tabs } from 'nextra/components'

# `addSafeOperation`

Creates a new 4337 SafeOperation with an initial signature.

## Usage

{/* <!-- vale off --> */}

<Tabs items={['exampleProps.ts', 'exampleOperation.ts', 'setup.ts']}>
  <Tabs.Tab>
    ```typescript
    import { addSafeOperationProps } from '@safe-global/api-kit'
    import { apiKit } from './setup.ts'

    const options: addSafeOperationProps = {
      entryPoint: '0x...',
      moduleAddress: '0x...',
      safeAddress: '0x...',
      userOperation: {
        sender: '0x...',
        nonce: '0x01',
        initCode: '0x',
        callData: '0x7bb374280000000000000000000000001c7d4b196cb0c7b01d743fbc6116a902379c72380000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000008000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000044a9059cbb00000000000000000000000060c4ab82d06fd7dfe9517e17736c2dcc77443ef000000000000000000000000000000000000000000000000000000000000186a000000000000000000000000000000000000000000000000000000000',
        callGasLimit: 2587142523901n,
        verificationGasLimit: 2587142523901n,
        preVerificationGas: 1810999766731n,
        maxFeePerGas: 1000000000n,
        maxPriorityFeePerGas: 1000000000n,
        paymasterAndData: '0x0000000000325602a77416A16136FDafd04b299f',
        signature: '0x3d7010c4f7e7a8a7dfc91220fdde2ccacfd14b7c751a0b94973ebca36249e44f22cfc9e63d0d4658d6db198b0ec1f69ed98a72ae0692b9e77337e7d4c4e31aca1c',
      },
      options: { // Optional
        validAfter: 0, // Optional
        validUntil: 0, // Optional
      }
    }

    await apiKit.addSafeOperation(safeAddress, options)
    ```
  </Tabs.Tab>
  <Tabs.Tab>
    ```typescript
    import { addSafeOperationProps } from '@safe-global/api-kit'
    import { MetaTransactionData } from '@safe-global/relay-kit'
    import { apiKit, safe4337Pack } from './setup.ts'

    const transactionData: MetaTransactionData = {
      to: '0x...',
      value: '10000',
      data: '0x',
      operation: 0, // Optional
    }

    const safeOperation = await safe4337Pack.createTransaction({ transactions: [transaction]})
    const signedSafeOperation = await safe4337Pack.signSafeOperation(safeOperation)
    await apiKit.addSafeOperation(signedSafeOperation)
    ```
  </Tabs.Tab>
  <Tabs.Tab>
    ```typescript
    import SafeApiKit from '@safe-global/api-kit'

    export const apiKit = new SafeApiKit({
      chainId: 1n, // Mainnet
    })

    export const safe4337Pack = await Safe4337Pack.init({
      ...options
    })
    ```
  </Tabs.Tab>
</Tabs>

{/* <!-- vale on --> */}

## Parameters

### `safeOperation`

- **Type:** `SafeOperation` | `AddSafeOperationProps`

Either the Safe Operation generated by the `createTransaction` of `Safe4337Pack` or `AddSafeOperationProps` that contains metadata and the `UserOperation`. A signature must be present in order for the operation to be added.

```typescript focus=2
await apiKit.addSafeOperation(
  safeOperation
)
```